using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace NugetAuditor.Lib.OSSIndex
{
    /*
    [
      {
        "uri": "cve:/CVE-2011-4969",
        "id": "348528",
        "cve-id": "CVE-2011-4969",
        "summary": "Cross-site scripting (XSS) vulnerability in jQuery before 1.6.3, when using location.hash to select elements, allows remote attackers to inject arbitrary web script or HTML via a crafted tag.",
        "details": "https://ossindex.net/v1.0/cve/348528",
        "versions": [
          "1.6",
          "1.6.1",
          "1.6.2"
        ]
      }
    ]
    */
    public class Vulnerability
    {
        public string CveId { get; set; }
        public string Details { get; set; }
        public string Id { get; set; }
        public string Summary { get; set; }
        public string Title { get; set; }
        public string Uri { get; set; }
        public List<string> Versions { get; set; }

        public bool AffectsVersion(string versionString)
        {
            return SemVer.Range.IsSatisfied(string.Join("||", this.Versions), versionString);
        }
    }
}
